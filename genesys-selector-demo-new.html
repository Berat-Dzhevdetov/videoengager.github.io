<!DOCTYPE html> 
<html>
   <head>
      <title>Genesys Selector Demo</title>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <script type="text/javascript" 	src="https://code.jquery.com/jquery-3.5.0.js"></script>		
      <script>
            function jsonConcat(o1, o2) {
                  for (var key in o2) {
                        o1[key] = o2[key];
                  }
                  return o1;
            }
            $.getJSON('https://apps.mypurecloud.com/widgets/9.0/i18n/widgets-fr.i18n.json', function(fr_data) {
                  var en_videoengager = {
                        "en_videochat": {
                              "webchat": {
                              "ChatFormSubmit": "Start Video",
                              "WebChatTitle": "Video Chat",
                              "WebChatName": "Video Chat",
                              "ChatTitle": "Video Chat",
                              },
                        }
                  }
                  var fr_videoengager = {
                        "fr_videochat": {
                              "webchat": {
                              "ChatFormSubmit": "Démarrer la vidéo",
                              "WebChatTitle": "Chat vidéo",
                              "WebChatName": "Chat vidéo",
                              "ChatTitle": "Chat vidéo",
                              },
                        }
                  }
                  var langData = jsonConcat(fr_data, en_videoengager);
                  langData = jsonConcat(langData, fr_videoengager);

                  const urlParams = new URLSearchParams(window.location.search);
                  const lang = urlParams.get('lang');

                  if (!window._genesys) window._genesys = {};
                  if (!window._gt) window._gt = [];
                  window._genesys.widgets = {
                        main: {
                              debug: true,
                              theme: "dark",
                              lang: lang ? lang : "en",
                              plugins: [
                              "cx-webchat",
                              "cx-webchat-service",
                              "cx-cobrowse",
                              "cx-channel-selector",
                              "cx-stats-service",
                              "cx-call-us",
                              "cx-callback-service",
                              "cx-callback",
                              "cx-calendar",
                              "cx-sidebar"
                              ],
                              i18n: langData
                        },
                        webchat: {
                              transport: {
                              type: 'purecloud-v2-sockets',
                              dataURL: 'https://api.mypurecloud.com',
                              deploymentKey: '973f8326-c601-40c6-82ce-b87e6dafef1c',
                              orgGuid: 'c4b553c3-ee42-4846-aeb1-f0da3d85058e',
                              interactionData: {
                                    routing: {
                                          targetType: 'QUEUE',
                                          targetAddress: 'TestQueue',
                                          priority: 2
                                    }
                              }

                              },
                              /*transport: {
                                    type: 'purecloud-v2-sockets',
                                    dataURL: 'https://api.mypurecloud.com.au',
                                    deploymentKey : 'c2eaaa5c-d755-4e51-9136-b5ee86b92af3',
                                    orgGuid : '327d10eb-0826-42cd-89b1-353ec67d33f8',
                                    interactionData: {
                                          routing: {      
                                                targetType: 'QUEUE',
                                                targetAddress: 'video',
                                                priority: 2
                                          }
                                    }
                              },*/
                              form: {
                              wrapper: "<table role='none'>",
                              inputs: [{
                                          id: "cx_sendmessage_form_firstname",
                                          name: "firstname",
                                          maxlength: "100",
                                          placeholder: "@i18n:sendmessage.PlaceholderFirstName",
                                          label: "@i18n:sendmessage.FirstName",
                                          autofocus: !0,
                                          "aria-required": !0
                                    },
                                    {
                                          id: "cx_sendmessage_form_lastname",
                                          name: "lastname",
                                          maxlength: "100",
                                          placeholder: "@i18n:sendmessage.PlaceholderLastName",
                                          label: "@i18n:sendmessage.LastName",
                                          "aria-required": !0
                                    },
                                    {
                                          id: "cx_sendmessage_form_email",
                                          type: "email",
                                          name: "email",
                                          maxlength: "100",
                                          placeholder: "@i18n:sendmessage.PlaceholderEmail",
                                          label: "@i18n:sendmessage.Email",
                                          "aria-required": !0
                                    },
                                    {
                                          id: "cx_sendmessage_form_subject",
                                          name: "subject",
                                          maxlength: "100",
                                          placeholder: "@i18n:sendmessage.PlaceholderSubject",
                                          label: "@i18n:sendmessage.Subject",
                                          "aria-required": !0
                                    },
                                    {
                                          id: "cx_sendmessage_form_messagebody",
                                          type: "textarea",
                                          name: "messagebody",
                                          placeholder: "@i18n:sendmessage.PlaceholderTypetexthere",
                                          label: !1,
                                          "aria-required": !0
                                    },
                                    // to add custom fields to web chat
                                    {
                                          value: "TEST",
                                          id: "cx_webchat_form_customField2",
                                          name: "customField2",
                                          maxlength: "100",
                                          placeholder: "TEST TEST",
                                          label: "TEST"
                                    },
                                    {
                                          value: "Subject",
                                          id: "cx_webchat_form_customFieldLabel2",
                                          name: "customField2Label",
                                          maxlength: "100",
                                          placeholder: "",
                                          label: !1,
                                          style: "display:none"
                                    },
                                    {
                                          value: "TEST",
                                          id: "cx_webchat_form_customField1",
                                          name: "customField1",
                                          maxlength: "100",
                                          placeholder: "Test 2",
                                          label: "Test 2"
                                    },
                                    {
                                          value: "BRAND NEW CUSTOM FIELD",
                                          id: "cx_webchat_form_customFieldLabel1",
                                          name: "customField1Label",
                                          maxlength: !1,
                                          placeholder: !1,
                                          label: !1,
                                          style: "display:none"
                                    },
                                    {
                                          "id": "cx_webchat_form_language",
                                          "name": "language",
                                          "maxlength": "100",
                                          "placeholder": "Optional",
                                          "label": "Language",
                                          "type": "select",
                                          "options": [{
                                          "text": "English",
                                          "value": "[DEV] - English"
                                          }, {
                                          "text": "Bilingual",
                                          "value": "[DEV] - Bilingual"
                                          }]
                                    },
                              ],
                              },
                              cometD: {
                              enabled: false,

                              },
                              autoInvite: {
                              enabled: true,
                              timeToInviteSeconds: 5,
                              inviteTimeoutSeconds: 30
                              },
                              chatButton: {
                              enabled: false,
                              openDelay: 1000,
                              effectDuration: 300,
                              hideDuringInvite: true
                              },
                              uploadsEnabled: true
                        },
                        channelselector: {
                              ewtRefreshInterval: 10,
                              channels: [{
                                    enable: true,
                                    clickCommand: 'VideoEngager.startVideo',
                                    readyEvent: 'VideoEngager.ready',
                                    displayName: 'Video Chat',
                                    i18n: 'VideoTitle',
                                    icon: 'videochat',
                                    ewt: {
                                          display: true,
                                          queue: 'Omnichannel',
                                          availabilityThresholdMin: 300,
                                          availabilityThresholdMax: 480,
                                          hideChannelWhenThresholdMax: false
                                    }
                              },
                              {
                                    enable: true,
                                    clickCommand: "WebChat.open",
                                    readyEvent: "WebChat.ready",
                                    displayName: "Web Chat",
                                    i10n: "ChatTitle",
                                    icon: "chat",
                                    html: "",
                                    ewt: {
                                          display: true,
                                          queue: "",
                                          availabilityThresholdMin: 300,
                                          availabilityThresholdMax: 3600,
                                          hideChannelWhenThresholdMax: false
                                    },
                                    onClick: function($, CXBus, Common) {
                                          var default_lang = window._genesys.widgets.main.lang;
                                          oVideoEngager.command('App.setLanguage', {
                                          lang: default_lang
                                          }).done(function(e) {
                                                //set language to default 
                                                _genesys.widgets.bus.command('WebChat.open');
                                          }).fail(function(e) {
                                                // App failed to set language
                                          });
                                    }
                              },
                              ]
                        },
                        sidebar: {
                              showOnStartup: true,
                              position: "right",
                              expandOnHover: true,
                              channels: [{
                              name: "ChannelSelector",
                              clickCommand: "ChannelSelector.open",
                              readyEvent: "ChannelSelector.ready",
                              clickOptions: {},
                              displayName: "Live Assistance",
                              displayTitle: "How would you like to get in touch?",
                              icon: "agent"
                              }, ]
                        }
                  };

                  (function(o){var f = function(){var d = o.location;o.aTags = o.aTags || [];
                  for(var i=0;i<o.aTags.length;i++){var oTag = o.aTags[i];var fs = d.getElementsByTagName(oTag.type)[0], e;
                  if(d.getElementById(oTag.id)) return; e = d.createElement(oTag.type); e.id = oTag.id;if(oTag.type == "script"){e.src = oTag.path;}
                  else{e.type = 'text/css';e.rel = 'stylesheet';e.href = oTag.path;}if(fs){fs.parentNode.insertBefore(e, fs);}else{d.head.appendChild(e);}
                  }},ol = window.onload;if(o.onload){typeof window.onload != "function"?window.onload=f:window.onload=function(){ol();f();}}else f();})({
                        location: document,
                        onload: false,
                        aTags: [{
                              type: "script",
                              id: "videoengager-widgets-script",
                              path: "videoengager/js/videoengager.widget.js"
                              },
                              {
                              type: "link",
                              id: "genesys-widgets-styles",
                              path: "widgets.min.css"
                              },
                        ]
                  });
                  var userData = {
                        firstName: 'Visitor',
                        lastName: 'Test',
                        autoSubmit: false
                  };
                  var formData = {
                        cedula: '1800973544'
                  };
                  document.addEventListener('VideoEngagerReady', function(e) {
                        //videoengager.init('myVideoHolder', 'purecloud', 'test_tenant', 'https://dev.videoengager.com/', formData, userData, true);
                        videoengager.init('myVideoHolder', 'purecloud', '0FphTk091nt7G1W7', 'https://videome.leadsecure.com/', formData, userData, true);
                        var s = document.createElement("script");
                        s.src = "widgets.min.js";
                        s.id = "genesys-widgets-script";
                        document.head.appendChild(s);
                  }, false);
            });
      </script>
      <style type="text/css"> body {
         background-image: url(./videoengager/img/ve.svg);
         background-repeat: no-repeat;
         background-size: contain;
         background-attachment: fixed;
         background-position: center;
         } 
      </style>
   </head>
   <body >
      <link id="genesys-widgets-styles" href="widgets.min.css" type="text/css" rel="stylesheet"/>
   </body>
</html>